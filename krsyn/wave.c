#include "math.h"
#include "synth.h"

static const i16 sin_table[ks_1(KS_TABLE_BITS)] = {
    0, 201, 402, 603, 804, 1005, 1206, 1406,
    1607, 1808, 2009, 2209, 2410, 2610, 2811, 3011,
    3211, 3411, 3611, 3811, 4011, 4210, 4409, 4608,
    4807, 5006, 5205, 5403, 5601, 5799, 5997, 6195,
    6392, 6589, 6786, 6982, 7179, 7375, 7571, 7766,
    7961, 8156, 8351, 8545, 8739, 8932, 9126, 9319,
    9511, 9703, 9895, 10087, 10278, 10469, 10659, 10849,
    11038, 11227, 11416, 11604, 11792, 11980, 12166, 12353,
    12539, 12724, 12909, 13094, 13278, 13462, 13645, 13827,
    14009, 14191, 14372, 14552, 14732, 14911, 15090, 15268,
    15446, 15623, 15799, 15975, 16150, 16325, 16499, 16672,
    16845, 17017, 17189, 17360, 17530, 17699, 17868, 18036,
    18204, 18371, 18537, 18702, 18867, 19031, 19194, 19357,
    19519, 19680, 19840, 20000, 20159, 20317, 20474, 20631,
    20787, 20942, 21096, 21249, 21402, 21554, 21705, 21855,
    22004, 22153, 22301, 22448, 22594, 22739, 22883, 23027,
    23169, 23311, 23452, 23592, 23731, 23869, 24006, 24143,
    24278, 24413, 24546, 24679, 24811, 24942, 25072, 25201,
    25329, 25456, 25582, 25707, 25831, 25954, 26077, 26198,
    26318, 26437, 26556, 26673, 26789, 26905, 27019, 27132,
    27244, 27355, 27466, 27575, 27683, 27790, 27896, 28001,
    28105, 28208, 28309, 28410, 28510, 28608, 28706, 28802,
    28897, 28992, 29085, 29177, 29268, 29358, 29446, 29534,
    29621, 29706, 29790, 29873, 29955, 30036, 30116, 30195,
    30272, 30349, 30424, 30498, 30571, 30643, 30713, 30783,
    30851, 30918, 30984, 31049, 31113, 31175, 31236, 31297,
    31356, 31413, 31470, 31525, 31580, 31633, 31684, 31735,
    31785, 31833, 31880, 31926, 31970, 32014, 32056, 32097,
    32137, 32176, 32213, 32249, 32284, 32318, 32350, 32382,
    32412, 32441, 32468, 32495, 32520, 32544, 32567, 32588,
    32609, 32628, 32646, 32662, 32678, 32692, 32705, 32717,
    32727, 32736, 32744, 32751, 32757, 32761, 32764, 32766,
    32767, 32766, 32764, 32761, 32757, 32751, 32744, 32736,
    32727, 32717, 32705, 32692, 32678, 32662, 32646, 32628,
    32609, 32588, 32567, 32544, 32520, 32495, 32468, 32441,
    32412, 32382, 32350, 32318, 32284, 32249, 32213, 32176,
    32137, 32097, 32056, 32014, 31970, 31926, 31880, 31833,
    31785, 31735, 31684, 31633, 31580, 31525, 31470, 31413,
    31356, 31297, 31236, 31175, 31113, 31049, 30984, 30918,
    30851, 30783, 30713, 30643, 30571, 30498, 30424, 30349,
    30272, 30195, 30116, 30036, 29955, 29873, 29790, 29706,
    29621, 29534, 29446, 29358, 29268, 29177, 29085, 28992,
    28897, 28802, 28706, 28608, 28510, 28410, 28309, 28208,
    28105, 28001, 27896, 27790, 27683, 27575, 27466, 27355,
    27244, 27132, 27019, 26905, 26789, 26673, 26556, 26437,
    26318, 26198, 26077, 25954, 25831, 25707, 25582, 25456,
    25329, 25201, 25072, 24942, 24811, 24679, 24546, 24413,
    24278, 24143, 24006, 23869, 23731, 23592, 23452, 23311,
    23169, 23027, 22883, 22739, 22594, 22448, 22301, 22153,
    22004, 21855, 21705, 21554, 21402, 21249, 21096, 20942,
    20787, 20631, 20474, 20317, 20159, 20000, 19840, 19680,
    19519, 19357, 19194, 19031, 18867, 18702, 18537, 18371,
    18204, 18036, 17868, 17699, 17530, 17360, 17189, 17017,
    16845, 16672, 16499, 16325, 16150, 15975, 15799, 15623,
    15446, 15268, 15090, 14911, 14732, 14552, 14372, 14191,
    14009, 13827, 13645, 13462, 13278, 13094, 12909, 12724,
    12539, 12353, 12166, 11980, 11792, 11604, 11416, 11227,
    11038, 10849, 10659, 10469, 10278, 10087, 9895, 9703,
    9511, 9319, 9126, 8932, 8739, 8545, 8351, 8156,
    7961, 7766, 7571, 7375, 7179, 6982, 6786, 6589,
    6392, 6195, 5997, 5799, 5601, 5403, 5205, 5006,
    4807, 4608, 4409, 4210, 4011, 3811, 3611, 3411,
    3211, 3011, 2811, 2610, 2410, 2209, 2009, 1808,
    1607, 1406, 1206, 1005, 804, 603, 402, 201,
    0, -201, -402, -603, -804, -1005, -1206, -1406,
    -1607, -1808, -2009, -2209, -2410, -2610, -2811, -3011,
    -3211, -3411, -3611, -3811, -4011, -4210, -4409, -4608,
    -4807, -5006, -5205, -5403, -5601, -5799, -5997, -6195,
    -6392, -6589, -6786, -6982, -7179, -7375, -7571, -7766,
    -7961, -8156, -8351, -8545, -8739, -8932, -9126, -9319,
    -9511, -9703, -9895, -10087, -10278, -10469, -10659, -10849,
    -11038, -11227, -11416, -11604, -11792, -11980, -12166, -12353,
    -12539, -12724, -12909, -13094, -13278, -13462, -13645, -13827,
    -14009, -14191, -14372, -14552, -14732, -14911, -15090, -15268,
    -15446, -15623, -15799, -15975, -16150, -16325, -16499, -16672,
    -16845, -17017, -17189, -17360, -17530, -17699, -17868, -18036,
    -18204, -18371, -18537, -18702, -18867, -19031, -19194, -19357,
    -19519, -19680, -19840, -20000, -20159, -20317, -20474, -20631,
    -20787, -20942, -21096, -21249, -21402, -21554, -21705, -21855,
    -22004, -22153, -22301, -22448, -22594, -22739, -22883, -23027,
    -23169, -23311, -23452, -23592, -23731, -23869, -24006, -24143,
    -24278, -24413, -24546, -24679, -24811, -24942, -25072, -25201,
    -25329, -25456, -25582, -25707, -25831, -25954, -26077, -26198,
    -26318, -26437, -26556, -26673, -26789, -26905, -27019, -27132,
    -27244, -27355, -27466, -27575, -27683, -27790, -27896, -28001,
    -28105, -28208, -28309, -28410, -28510, -28608, -28706, -28802,
    -28897, -28992, -29085, -29177, -29268, -29358, -29446, -29534,
    -29621, -29706, -29790, -29873, -29955, -30036, -30116, -30195,
    -30272, -30349, -30424, -30498, -30571, -30643, -30713, -30783,
    -30851, -30918, -30984, -31049, -31113, -31175, -31236, -31297,
    -31356, -31413, -31470, -31525, -31580, -31633, -31684, -31735,
    -31785, -31833, -31880, -31926, -31970, -32014, -32056, -32097,
    -32137, -32176, -32213, -32249, -32284, -32318, -32350, -32382,
    -32412, -32441, -32468, -32495, -32520, -32544, -32567, -32588,
    -32609, -32628, -32646, -32662, -32678, -32692, -32705, -32717,
    -32727, -32736, -32744, -32751, -32757, -32761, -32764, -32766,
    -32767, -32766, -32764, -32761, -32757, -32751, -32744, -32736,
    -32727, -32717, -32705, -32692, -32678, -32662, -32646, -32628,
    -32609, -32588, -32567, -32544, -32520, -32495, -32468, -32441,
    -32412, -32382, -32350, -32318, -32284, -32249, -32213, -32176,
    -32137, -32097, -32056, -32014, -31970, -31926, -31880, -31833,
    -31785, -31735, -31684, -31633, -31580, -31525, -31470, -31413,
    -31356, -31297, -31236, -31175, -31113, -31049, -30984, -30918,
    -30851, -30783, -30713, -30643, -30571, -30498, -30424, -30349,
    -30272, -30195, -30116, -30036, -29955, -29873, -29790, -29706,
    -29621, -29534, -29446, -29358, -29268, -29177, -29085, -28992,
    -28897, -28802, -28706, -28608, -28510, -28410, -28309, -28208,
    -28105, -28001, -27896, -27790, -27683, -27575, -27466, -27355,
    -27244, -27132, -27019, -26905, -26789, -26673, -26556, -26437,
    -26318, -26198, -26077, -25954, -25831, -25707, -25582, -25456,
    -25329, -25201, -25072, -24942, -24811, -24679, -24546, -24413,
    -24278, -24143, -24006, -23869, -23731, -23592, -23452, -23311,
    -23169, -23027, -22883, -22739, -22594, -22448, -22301, -22153,
    -22004, -21855, -21705, -21554, -21402, -21249, -21096, -20942,
    -20787, -20631, -20474, -20317, -20159, -20000, -19840, -19680,
    -19519, -19357, -19194, -19031, -18867, -18702, -18537, -18371,
    -18204, -18036, -17868, -17699, -17530, -17360, -17189, -17017,
    -16845, -16672, -16499, -16325, -16150, -15975, -15799, -15623,
    -15446, -15268, -15090, -14911, -14732, -14552, -14372, -14191,
    -14009, -13827, -13645, -13462, -13278, -13094, -12909, -12724,
    -12539, -12353, -12166, -11980, -11792, -11604, -11416, -11227,
    -11038, -10849, -10659, -10469, -10278, -10087, -9895, -9703,
    -9511, -9319, -9126, -8932, -8739, -8545, -8351, -8156,
    -7961, -7766, -7571, -7375, -7179, -6982, -6786, -6589,
    -6392, -6195, -5997, -5799, -5601, -5403, -5205, -5006,
    -4807, -4608, -4409, -4210, -4011, -3811, -3611, -3411,
    -3211, -3011, -2811, -2610, -2410, -2209, -2009, -1808,
    -1607, -1406, -1206, -1005, -804, -603, -402, -201,
};
static const i16 saw_table[ks_1(KS_TABLE_BITS)] = {
    32767, 32704, 32640, 32576, 32512, 32448, 32384, 32320,
    32256, 32192, 32128, 32064, 32000, 31936, 31872, 31808,
    31744, 31680, 31616, 31552, 31488, 31424, 31360, 31296,
    31232, 31168, 31104, 31040, 30976, 30912, 30848, 30784,
    30720, 30656, 30592, 30528, 30464, 30400, 30336, 30272,
    30208, 30144, 30080, 30016, 29952, 29888, 29824, 29760,
    29696, 29632, 29568, 29504, 29440, 29376, 29312, 29248,
    29184, 29120, 29056, 28992, 28928, 28864, 28800, 28736,
    28672, 28608, 28544, 28480, 28416, 28352, 28288, 28224,
    28160, 28096, 28032, 27968, 27904, 27840, 27776, 27712,
    27648, 27584, 27520, 27456, 27392, 27328, 27264, 27200,
    27136, 27072, 27008, 26944, 26880, 26816, 26752, 26688,
    26624, 26560, 26496, 26432, 26368, 26304, 26240, 26176,
    26112, 26048, 25984, 25920, 25856, 25792, 25728, 25664,
    25600, 25536, 25472, 25408, 25344, 25280, 25216, 25152,
    25088, 25024, 24960, 24896, 24832, 24768, 24704, 24640,
    24576, 24512, 24448, 24384, 24320, 24256, 24192, 24128,
    24064, 24000, 23936, 23872, 23808, 23744, 23680, 23616,
    23552, 23488, 23424, 23360, 23296, 23232, 23168, 23104,
    23040, 22976, 22912, 22848, 22784, 22720, 22656, 22592,
    22528, 22464, 22400, 22336, 22272, 22208, 22144, 22080,
    22016, 21952, 21888, 21824, 21760, 21696, 21632, 21568,
    21504, 21440, 21376, 21312, 21248, 21184, 21120, 21056,
    20992, 20928, 20864, 20800, 20736, 20672, 20608, 20544,
    20480, 20416, 20352, 20288, 20224, 20160, 20096, 20032,
    19968, 19904, 19840, 19776, 19712, 19648, 19584, 19520,
    19456, 19392, 19328, 19264, 19200, 19136, 19072, 19008,
    18944, 18880, 18816, 18752, 18688, 18624, 18560, 18496,
    18432, 18368, 18304, 18240, 18176, 18112, 18048, 17984,
    17920, 17856, 17792, 17728, 17664, 17600, 17536, 17472,
    17408, 17344, 17280, 17216, 17152, 17088, 17024, 16960,
    16896, 16832, 16768, 16704, 16640, 16576, 16512, 16448,
    16384, 16320, 16256, 16192, 16128, 16064, 16000, 15936,
    15872, 15808, 15744, 15680, 15616, 15552, 15488, 15424,
    15360, 15296, 15232, 15168, 15104, 15040, 14976, 14912,
    14848, 14784, 14720, 14656, 14592, 14528, 14464, 14400,
    14336, 14272, 14208, 14144, 14080, 14016, 13952, 13888,
    13824, 13760, 13696, 13632, 13568, 13504, 13440, 13376,
    13312, 13248, 13184, 13120, 13056, 12992, 12928, 12864,
    12800, 12736, 12672, 12608, 12544, 12480, 12416, 12352,
    12288, 12224, 12160, 12096, 12032, 11968, 11904, 11840,
    11776, 11712, 11648, 11584, 11520, 11456, 11392, 11328,
    11264, 11200, 11136, 11072, 11008, 10944, 10880, 10816,
    10752, 10688, 10624, 10560, 10496, 10432, 10368, 10304,
    10240, 10176, 10112, 10048, 9984, 9920, 9856, 9792,
    9728, 9664, 9600, 9536, 9472, 9408, 9344, 9280,
    9216, 9152, 9088, 9024, 8960, 8896, 8832, 8768,
    8704, 8640, 8576, 8512, 8448, 8384, 8320, 8256,
    8192, 8128, 8064, 8000, 7936, 7872, 7808, 7744,
    7680, 7616, 7552, 7488, 7424, 7360, 7296, 7232,
    7168, 7104, 7040, 6976, 6912, 6848, 6784, 6720,
    6656, 6592, 6528, 6464, 6400, 6336, 6272, 6208,
    6144, 6080, 6016, 5952, 5888, 5824, 5760, 5696,
    5632, 5568, 5504, 5440, 5376, 5312, 5248, 5184,
    5120, 5056, 4992, 4928, 4864, 4800, 4736, 4672,
    4608, 4544, 4480, 4416, 4352, 4288, 4224, 4160,
    4096, 4032, 3968, 3904, 3840, 3776, 3712, 3648,
    3584, 3520, 3456, 3392, 3328, 3264, 3200, 3136,
    3072, 3008, 2944, 2880, 2816, 2752, 2688, 2624,
    2560, 2496, 2432, 2368, 2304, 2240, 2176, 2112,
    2048, 1984, 1920, 1856, 1792, 1728, 1664, 1600,
    1536, 1472, 1408, 1344, 1280, 1216, 1152, 1088,
    1024, 960, 896, 832, 768, 704, 640, 576,
    512, 448, 384, 320, 256, 192, 128, 64,
    0, -63, -127, -191, -255, -319, -383, -447,
    -511, -575, -639, -703, -767, -831, -895, -959,
    -1023, -1087, -1151, -1215, -1279, -1343, -1407, -1471,
    -1535, -1599, -1663, -1727, -1791, -1855, -1919, -1983,
    -2047, -2111, -2175, -2239, -2303, -2367, -2431, -2495,
    -2559, -2623, -2687, -2751, -2815, -2879, -2943, -3007,
    -3071, -3135, -3199, -3263, -3327, -3391, -3455, -3519,
    -3583, -3647, -3711, -3775, -3839, -3903, -3967, -4031,
    -4095, -4159, -4223, -4287, -4351, -4415, -4479, -4543,
    -4607, -4671, -4735, -4799, -4863, -4927, -4991, -5055,
    -5119, -5183, -5247, -5311, -5375, -5439, -5503, -5567,
    -5631, -5695, -5759, -5823, -5887, -5951, -6015, -6079,
    -6143, -6207, -6271, -6335, -6399, -6463, -6527, -6591,
    -6655, -6719, -6783, -6847, -6911, -6975, -7039, -7103,
    -7167, -7231, -7295, -7359, -7423, -7487, -7551, -7615,
    -7679, -7743, -7807, -7871, -7935, -7999, -8063, -8127,
    -8191, -8255, -8319, -8383, -8447, -8511, -8575, -8639,
    -8703, -8767, -8831, -8895, -8959, -9023, -9087, -9151,
    -9215, -9279, -9343, -9407, -9471, -9535, -9599, -9663,
    -9727, -9791, -9855, -9919, -9983, -10047, -10111, -10175,
    -10239, -10303, -10367, -10431, -10495, -10559, -10623, -10687,
    -10751, -10815, -10879, -10943, -11007, -11071, -11135, -11199,
    -11263, -11327, -11391, -11455, -11519, -11583, -11647, -11711,
    -11775, -11839, -11903, -11967, -12031, -12095, -12159, -12223,
    -12287, -12351, -12415, -12479, -12543, -12607, -12671, -12735,
    -12799, -12863, -12927, -12991, -13055, -13119, -13183, -13247,
    -13311, -13375, -13439, -13503, -13567, -13631, -13695, -13759,
    -13823, -13887, -13951, -14015, -14079, -14143, -14207, -14271,
    -14335, -14399, -14463, -14527, -14591, -14655, -14719, -14783,
    -14847, -14911, -14975, -15039, -15103, -15167, -15231, -15295,
    -15359, -15423, -15487, -15551, -15615, -15679, -15743, -15807,
    -15871, -15935, -15999, -16063, -16127, -16191, -16255, -16319,
    -16383, -16447, -16511, -16575, -16639, -16703, -16767, -16831,
    -16895, -16959, -17023, -17087, -17151, -17215, -17279, -17343,
    -17407, -17471, -17535, -17599, -17663, -17727, -17791, -17855,
    -17919, -17983, -18047, -18111, -18175, -18239, -18303, -18367,
    -18431, -18495, -18559, -18623, -18687, -18751, -18815, -18879,
    -18943, -19007, -19071, -19135, -19199, -19263, -19327, -19391,
    -19455, -19519, -19583, -19647, -19711, -19775, -19839, -19903,
    -19967, -20031, -20095, -20159, -20223, -20287, -20351, -20415,
    -20479, -20543, -20607, -20671, -20735, -20799, -20863, -20927,
    -20991, -21055, -21119, -21183, -21247, -21311, -21375, -21439,
    -21503, -21567, -21631, -21695, -21759, -21823, -21887, -21951,
    -22015, -22079, -22143, -22207, -22271, -22335, -22399, -22463,
    -22527, -22591, -22655, -22719, -22783, -22847, -22911, -22975,
    -23039, -23103, -23167, -23231, -23295, -23359, -23423, -23487,
    -23551, -23615, -23679, -23743, -23807, -23871, -23935, -23999,
    -24063, -24127, -24191, -24255, -24319, -24383, -24447, -24511,
    -24575, -24639, -24703, -24767, -24831, -24895, -24959, -25023,
    -25087, -25151, -25215, -25279, -25343, -25407, -25471, -25535,
    -25599, -25663, -25727, -25791, -25855, -25919, -25983, -26047,
    -26111, -26175, -26239, -26303, -26367, -26431, -26495, -26559,
    -26623, -26687, -26751, -26815, -26879, -26943, -27007, -27071,
    -27135, -27199, -27263, -27327, -27391, -27455, -27519, -27583,
    -27647, -27711, -27775, -27839, -27903, -27967, -28031, -28095,
    -28159, -28223, -28287, -28351, -28415, -28479, -28543, -28607,
    -28671, -28735, -28799, -28863, -28927, -28991, -29055, -29119,
    -29183, -29247, -29311, -29375, -29439, -29503, -29567, -29631,
    -29695, -29759, -29823, -29887, -29951, -30015, -30079, -30143,
    -30207, -30271, -30335, -30399, -30463, -30527, -30591, -30655,
    -30719, -30783, -30847, -30911, -30975, -31039, -31103, -31167,
    -31231, -31295, -31359, -31423, -31487, -31551, -31615, -31679,
    -31743, -31807, -31871, -31935, -31999, -32063, -32127, -32191,
    -32255, -32319, -32383, -32447, -32511, -32575, -32639, -32703,
};
static const i16 saw_minus_table[ks_1(KS_TABLE_BITS)] = {
    -32767, -32703, -32639, -32575, -32511, -32447, -32383, -32319,
    -32255, -32191, -32127, -32063, -31999, -31935, -31871, -31807,
    -31743, -31679, -31615, -31551, -31487, -31423, -31359, -31295,
    -31231, -31167, -31103, -31039, -30975, -30911, -30847, -30783,
    -30719, -30655, -30591, -30527, -30463, -30399, -30335, -30271,
    -30207, -30143, -30079, -30015, -29951, -29887, -29823, -29759,
    -29695, -29631, -29567, -29503, -29439, -29375, -29311, -29247,
    -29183, -29119, -29055, -28991, -28927, -28863, -28799, -28735,
    -28671, -28607, -28543, -28479, -28415, -28351, -28287, -28223,
    -28159, -28095, -28031, -27967, -27903, -27839, -27775, -27711,
    -27647, -27583, -27519, -27455, -27391, -27327, -27263, -27199,
    -27135, -27071, -27007, -26943, -26879, -26815, -26751, -26687,
    -26623, -26559, -26495, -26431, -26367, -26303, -26239, -26175,
    -26111, -26047, -25983, -25919, -25855, -25791, -25727, -25663,
    -25599, -25535, -25471, -25407, -25343, -25279, -25215, -25151,
    -25087, -25023, -24959, -24895, -24831, -24767, -24703, -24639,
    -24575, -24511, -24447, -24383, -24319, -24255, -24191, -24127,
    -24063, -23999, -23935, -23871, -23807, -23743, -23679, -23615,
    -23551, -23487, -23423, -23359, -23295, -23231, -23167, -23103,
    -23039, -22975, -22911, -22847, -22783, -22719, -22655, -22591,
    -22527, -22463, -22399, -22335, -22271, -22207, -22143, -22079,
    -22015, -21951, -21887, -21823, -21759, -21695, -21631, -21567,
    -21503, -21439, -21375, -21311, -21247, -21183, -21119, -21055,
    -20991, -20927, -20863, -20799, -20735, -20671, -20607, -20543,
    -20479, -20415, -20351, -20287, -20223, -20159, -20095, -20031,
    -19967, -19903, -19839, -19775, -19711, -19647, -19583, -19519,
    -19455, -19391, -19327, -19263, -19199, -19135, -19071, -19007,
    -18943, -18879, -18815, -18751, -18687, -18623, -18559, -18495,
    -18431, -18367, -18303, -18239, -18175, -18111, -18047, -17983,
    -17919, -17855, -17791, -17727, -17663, -17599, -17535, -17471,
    -17407, -17343, -17279, -17215, -17151, -17087, -17023, -16959,
    -16895, -16831, -16767, -16703, -16639, -16575, -16511, -16447,
    -16383, -16319, -16255, -16191, -16127, -16063, -15999, -15935,
    -15871, -15807, -15743, -15679, -15615, -15551, -15487, -15423,
    -15359, -15295, -15231, -15167, -15103, -15039, -14975, -14911,
    -14847, -14783, -14719, -14655, -14591, -14527, -14463, -14399,
    -14335, -14271, -14207, -14143, -14079, -14015, -13951, -13887,
    -13823, -13759, -13695, -13631, -13567, -13503, -13439, -13375,
    -13311, -13247, -13183, -13119, -13055, -12991, -12927, -12863,
    -12799, -12735, -12671, -12607, -12543, -12479, -12415, -12351,
    -12287, -12223, -12159, -12095, -12031, -11967, -11903, -11839,
    -11775, -11711, -11647, -11583, -11519, -11455, -11391, -11327,
    -11263, -11199, -11135, -11071, -11007, -10943, -10879, -10815,
    -10751, -10687, -10623, -10559, -10495, -10431, -10367, -10303,
    -10239, -10175, -10111, -10047, -9983, -9919, -9855, -9791,
    -9727, -9663, -9599, -9535, -9471, -9407, -9343, -9279,
    -9215, -9151, -9087, -9023, -8959, -8895, -8831, -8767,
    -8703, -8639, -8575, -8511, -8447, -8383, -8319, -8255,
    -8191, -8127, -8063, -7999, -7935, -7871, -7807, -7743,
    -7679, -7615, -7551, -7487, -7423, -7359, -7295, -7231,
    -7167, -7103, -7039, -6975, -6911, -6847, -6783, -6719,
    -6655, -6591, -6527, -6463, -6399, -6335, -6271, -6207,
    -6143, -6079, -6015, -5951, -5887, -5823, -5759, -5695,
    -5631, -5567, -5503, -5439, -5375, -5311, -5247, -5183,
    -5119, -5055, -4991, -4927, -4863, -4799, -4735, -4671,
    -4607, -4543, -4479, -4415, -4351, -4287, -4223, -4159,
    -4095, -4031, -3967, -3903, -3839, -3775, -3711, -3647,
    -3583, -3519, -3455, -3391, -3327, -3263, -3199, -3135,
    -3071, -3007, -2943, -2879, -2815, -2751, -2687, -2623,
    -2559, -2495, -2431, -2367, -2303, -2239, -2175, -2111,
    -2047, -1983, -1919, -1855, -1791, -1727, -1663, -1599,
    -1535, -1471, -1407, -1343, -1279, -1215, -1151, -1087,
    -1023, -959, -895, -831, -767, -703, -639, -575,
    -511, -447, -383, -319, -255, -191, -127, -63,
    0, 63, 127, 191, 255, 319, 383, 447,
    511, 575, 639, 703, 767, 831, 895, 959,
    1023, 1087, 1151, 1215, 1279, 1343, 1407, 1471,
    1535, 1599, 1663, 1727, 1791, 1855, 1919, 1983,
    2047, 2111, 2175, 2239, 2303, 2367, 2431, 2495,
    2559, 2623, 2687, 2751, 2815, 2879, 2943, 3007,
    3071, 3135, 3199, 3263, 3327, 3391, 3455, 3519,
    3583, 3647, 3711, 3775, 3839, 3903, 3967, 4031,
    4095, 4159, 4223, 4287, 4351, 4415, 4479, 4543,
    4607, 4671, 4735, 4799, 4863, 4927, 4991, 5055,
    5119, 5183, 5247, 5311, 5375, 5439, 5503, 5567,
    5631, 5695, 5759, 5823, 5887, 5951, 6015, 6079,
    6143, 6207, 6271, 6335, 6399, 6463, 6527, 6591,
    6655, 6719, 6783, 6847, 6911, 6975, 7039, 7103,
    7167, 7231, 7295, 7359, 7423, 7487, 7551, 7615,
    7679, 7743, 7807, 7871, 7935, 7999, 8063, 8127,
    8191, 8255, 8319, 8383, 8447, 8511, 8575, 8639,
    8703, 8767, 8831, 8895, 8959, 9023, 9087, 9151,
    9215, 9279, 9343, 9407, 9471, 9535, 9599, 9663,
    9727, 9791, 9855, 9919, 9983, 10047, 10111, 10175,
    10239, 10303, 10367, 10431, 10495, 10559, 10623, 10687,
    10751, 10815, 10879, 10943, 11007, 11071, 11135, 11199,
    11263, 11327, 11391, 11455, 11519, 11583, 11647, 11711,
    11775, 11839, 11903, 11967, 12031, 12095, 12159, 12223,
    12287, 12351, 12415, 12479, 12543, 12607, 12671, 12735,
    12799, 12863, 12927, 12991, 13055, 13119, 13183, 13247,
    13311, 13375, 13439, 13503, 13567, 13631, 13695, 13759,
    13823, 13887, 13951, 14015, 14079, 14143, 14207, 14271,
    14335, 14399, 14463, 14527, 14591, 14655, 14719, 14783,
    14847, 14911, 14975, 15039, 15103, 15167, 15231, 15295,
    15359, 15423, 15487, 15551, 15615, 15679, 15743, 15807,
    15871, 15935, 15999, 16063, 16127, 16191, 16255, 16319,
    16383, 16447, 16511, 16575, 16639, 16703, 16767, 16831,
    16895, 16959, 17023, 17087, 17151, 17215, 17279, 17343,
    17407, 17471, 17535, 17599, 17663, 17727, 17791, 17855,
    17919, 17983, 18047, 18111, 18175, 18239, 18303, 18367,
    18431, 18495, 18559, 18623, 18687, 18751, 18815, 18879,
    18943, 19007, 19071, 19135, 19199, 19263, 19327, 19391,
    19455, 19519, 19583, 19647, 19711, 19775, 19839, 19903,
    19967, 20031, 20095, 20159, 20223, 20287, 20351, 20415,
    20479, 20543, 20607, 20671, 20735, 20799, 20863, 20927,
    20991, 21055, 21119, 21183, 21247, 21311, 21375, 21439,
    21503, 21567, 21631, 21695, 21759, 21823, 21887, 21951,
    22015, 22079, 22143, 22207, 22271, 22335, 22399, 22463,
    22527, 22591, 22655, 22719, 22783, 22847, 22911, 22975,
    23039, 23103, 23167, 23231, 23295, 23359, 23423, 23487,
    23551, 23615, 23679, 23743, 23807, 23871, 23935, 23999,
    24063, 24127, 24191, 24255, 24319, 24383, 24447, 24511,
    24575, 24639, 24703, 24767, 24831, 24895, 24959, 25023,
    25087, 25151, 25215, 25279, 25343, 25407, 25471, 25535,
    25599, 25663, 25727, 25791, 25855, 25919, 25983, 26047,
    26111, 26175, 26239, 26303, 26367, 26431, 26495, 26559,
    26623, 26687, 26751, 26815, 26879, 26943, 27007, 27071,
    27135, 27199, 27263, 27327, 27391, 27455, 27519, 27583,
    27647, 27711, 27775, 27839, 27903, 27967, 28031, 28095,
    28159, 28223, 28287, 28351, 28415, 28479, 28543, 28607,
    28671, 28735, 28799, 28863, 28927, 28991, 29055, 29119,
    29183, 29247, 29311, 29375, 29439, 29503, 29567, 29631,
    29695, 29759, 29823, 29887, 29951, 30015, 30079, 30143,
    30207, 30271, 30335, 30399, 30463, 30527, 30591, 30655,
    30719, 30783, 30847, 30911, 30975, 31039, 31103, 31167,
    31231, 31295, 31359, 31423, 31487, 31551, 31615, 31679,
    31743, 31807, 31871, 31935, 31999, 32063, 32127, 32191,
    32255, 32319, 32383, 32447, 32511, 32575, 32639, 32703,
};

static const i16 triangle_table[ks_1(KS_TABLE_BITS)] = {
    0, 127, 255, 383, 511, 639, 767, 895,
    1023, 1151, 1279, 1407, 1535, 1663, 1791, 1919,
    2047, 2175, 2303, 2431, 2559, 2687, 2815, 2943,
    3071, 3199, 3327, 3455, 3583, 3711, 3839, 3967,
    4095, 4223, 4351, 4479, 4607, 4735, 4863, 4991,
    5119, 5247, 5375, 5503, 5631, 5759, 5887, 6015,
    6143, 6271, 6399, 6527, 6655, 6783, 6911, 7039,
    7167, 7295, 7423, 7551, 7679, 7807, 7935, 8063,
    8191, 8319, 8447, 8575, 8703, 8831, 8959, 9087,
    9215, 9343, 9471, 9599, 9727, 9855, 9983, 10111,
    10239, 10367, 10495, 10623, 10751, 10879, 11007, 11135,
    11263, 11391, 11519, 11647, 11775, 11903, 12031, 12159,
    12287, 12415, 12543, 12671, 12799, 12927, 13055, 13183,
    13311, 13439, 13567, 13695, 13823, 13951, 14079, 14207,
    14335, 14463, 14591, 14719, 14847, 14975, 15103, 15231,
    15359, 15487, 15615, 15743, 15871, 15999, 16127, 16255,
    16383, 16511, 16639, 16767, 16895, 17023, 17151, 17279,
    17407, 17535, 17663, 17791, 17919, 18047, 18175, 18303,
    18431, 18559, 18687, 18815, 18943, 19071, 19199, 19327,
    19455, 19583, 19711, 19839, 19967, 20095, 20223, 20351,
    20479, 20607, 20735, 20863, 20991, 21119, 21247, 21375,
    21503, 21631, 21759, 21887, 22015, 22143, 22271, 22399,
    22527, 22655, 22783, 22911, 23039, 23167, 23295, 23423,
    23551, 23679, 23807, 23935, 24063, 24191, 24319, 24447,
    24575, 24703, 24831, 24959, 25087, 25215, 25343, 25471,
    25599, 25727, 25855, 25983, 26111, 26239, 26367, 26495,
    26623, 26751, 26879, 27007, 27135, 27263, 27391, 27519,
    27647, 27775, 27903, 28031, 28159, 28287, 28415, 28543,
    28671, 28799, 28927, 29055, 29183, 29311, 29439, 29567,
    29695, 29823, 29951, 30079, 30207, 30335, 30463, 30591,
    30719, 30847, 30975, 31103, 31231, 31359, 31487, 31615,
    31743, 31871, 31999, 32127, 32255, 32383, 32511, 32639,
    32767, 32639, 32511, 32383, 32255, 32127, 31999, 31871,
    31743, 31615, 31487, 31359, 31231, 31103, 30975, 30847,
    30719, 30591, 30463, 30335, 30207, 30079, 29951, 29823,
    29695, 29567, 29439, 29311, 29183, 29055, 28927, 28799,
    28671, 28543, 28415, 28287, 28159, 28031, 27903, 27775,
    27647, 27519, 27391, 27263, 27135, 27007, 26879, 26751,
    26623, 26495, 26367, 26239, 26111, 25983, 25855, 25727,
    25599, 25471, 25343, 25215, 25087, 24959, 24831, 24703,
    24575, 24447, 24319, 24191, 24063, 23935, 23807, 23679,
    23551, 23423, 23295, 23167, 23039, 22911, 22783, 22655,
    22527, 22399, 22271, 22143, 22015, 21887, 21759, 21631,
    21503, 21375, 21247, 21119, 20991, 20863, 20735, 20607,
    20479, 20351, 20223, 20095, 19967, 19839, 19711, 19583,
    19455, 19327, 19199, 19071, 18943, 18815, 18687, 18559,
    18431, 18303, 18175, 18047, 17919, 17791, 17663, 17535,
    17407, 17279, 17151, 17023, 16895, 16767, 16639, 16511,
    16383, 16255, 16127, 15999, 15871, 15743, 15615, 15487,
    15359, 15231, 15103, 14975, 14847, 14719, 14591, 14463,
    14335, 14207, 14079, 13951, 13823, 13695, 13567, 13439,
    13311, 13183, 13055, 12927, 12799, 12671, 12543, 12415,
    12287, 12159, 12031, 11903, 11775, 11647, 11519, 11391,
    11263, 11135, 11007, 10879, 10751, 10623, 10495, 10367,
    10239, 10111, 9983, 9855, 9727, 9599, 9471, 9343,
    9215, 9087, 8959, 8831, 8703, 8575, 8447, 8319,
    8191, 8063, 7935, 7807, 7679, 7551, 7423, 7295,
    7167, 7039, 6911, 6783, 6655, 6527, 6399, 6271,
    6143, 6015, 5887, 5759, 5631, 5503, 5375, 5247,
    5119, 4991, 4863, 4735, 4607, 4479, 4351, 4223,
    4095, 3967, 3839, 3711, 3583, 3455, 3327, 3199,
    3071, 2943, 2815, 2687, 2559, 2431, 2303, 2175,
    2047, 1919, 1791, 1663, 1535, 1407, 1279, 1151,
    1023, 895, 767, 639, 511, 383, 255, 127,
    0, -127, -255, -383, -511, -639, -767, -895,
    -1023, -1151, -1279, -1407, -1535, -1663, -1791, -1919,
    -2047, -2175, -2303, -2431, -2559, -2687, -2815, -2943,
    -3071, -3199, -3327, -3455, -3583, -3711, -3839, -3967,
    -4095, -4223, -4351, -4479, -4607, -4735, -4863, -4991,
    -5119, -5247, -5375, -5503, -5631, -5759, -5887, -6015,
    -6143, -6271, -6399, -6527, -6655, -6783, -6911, -7039,
    -7167, -7295, -7423, -7551, -7679, -7807, -7935, -8063,
    -8191, -8319, -8447, -8575, -8703, -8831, -8959, -9087,
    -9215, -9343, -9471, -9599, -9727, -9855, -9983, -10111,
    -10239, -10367, -10495, -10623, -10751, -10879, -11007, -11135,
    -11263, -11391, -11519, -11647, -11775, -11903, -12031, -12159,
    -12287, -12415, -12543, -12671, -12799, -12927, -13055, -13183,
    -13311, -13439, -13567, -13695, -13823, -13951, -14079, -14207,
    -14335, -14463, -14591, -14719, -14847, -14975, -15103, -15231,
    -15359, -15487, -15615, -15743, -15871, -15999, -16127, -16255,
    -16383, -16511, -16639, -16767, -16895, -17023, -17151, -17279,
    -17407, -17535, -17663, -17791, -17919, -18047, -18175, -18303,
    -18431, -18559, -18687, -18815, -18943, -19071, -19199, -19327,
    -19455, -19583, -19711, -19839, -19967, -20095, -20223, -20351,
    -20479, -20607, -20735, -20863, -20991, -21119, -21247, -21375,
    -21503, -21631, -21759, -21887, -22015, -22143, -22271, -22399,
    -22527, -22655, -22783, -22911, -23039, -23167, -23295, -23423,
    -23551, -23679, -23807, -23935, -24063, -24191, -24319, -24447,
    -24575, -24703, -24831, -24959, -25087, -25215, -25343, -25471,
    -25599, -25727, -25855, -25983, -26111, -26239, -26367, -26495,
    -26623, -26751, -26879, -27007, -27135, -27263, -27391, -27519,
    -27647, -27775, -27903, -28031, -28159, -28287, -28415, -28543,
    -28671, -28799, -28927, -29055, -29183, -29311, -29439, -29567,
    -29695, -29823, -29951, -30079, -30207, -30335, -30463, -30591,
    -30719, -30847, -30975, -31103, -31231, -31359, -31487, -31615,
    -31743, -31871, -31999, -32127, -32255, -32383, -32511, -32639,
    -32767, -32639, -32511, -32383, -32255, -32127, -31999, -31871,
    -31743, -31615, -31487, -31359, -31231, -31103, -30975, -30847,
    -30719, -30591, -30463, -30335, -30207, -30079, -29951, -29823,
    -29695, -29567, -29439, -29311, -29183, -29055, -28927, -28799,
    -28671, -28543, -28415, -28287, -28159, -28031, -27903, -27775,
    -27647, -27519, -27391, -27263, -27135, -27007, -26879, -26751,
    -26623, -26495, -26367, -26239, -26111, -25983, -25855, -25727,
    -25599, -25471, -25343, -25215, -25087, -24959, -24831, -24703,
    -24575, -24447, -24319, -24191, -24063, -23935, -23807, -23679,
    -23551, -23423, -23295, -23167, -23039, -22911, -22783, -22655,
    -22527, -22399, -22271, -22143, -22015, -21887, -21759, -21631,
    -21503, -21375, -21247, -21119, -20991, -20863, -20735, -20607,
    -20479, -20351, -20223, -20095, -19967, -19839, -19711, -19583,
    -19455, -19327, -19199, -19071, -18943, -18815, -18687, -18559,
    -18431, -18303, -18175, -18047, -17919, -17791, -17663, -17535,
    -17407, -17279, -17151, -17023, -16895, -16767, -16639, -16511,
    -16383, -16255, -16127, -15999, -15871, -15743, -15615, -15487,
    -15359, -15231, -15103, -14975, -14847, -14719, -14591, -14463,
    -14335, -14207, -14079, -13951, -13823, -13695, -13567, -13439,
    -13311, -13183, -13055, -12927, -12799, -12671, -12543, -12415,
    -12287, -12159, -12031, -11903, -11775, -11647, -11519, -11391,
    -11263, -11135, -11007, -10879, -10751, -10623, -10495, -10367,
    -10239, -10111, -9983, -9855, -9727, -9599, -9471, -9343,
    -9215, -9087, -8959, -8831, -8703, -8575, -8447, -8319,
    -8191, -8063, -7935, -7807, -7679, -7551, -7423, -7295,
    -7167, -7039, -6911, -6783, -6655, -6527, -6399, -6271,
    -6143, -6015, -5887, -5759, -5631, -5503, -5375, -5247,
    -5119, -4991, -4863, -4735, -4607, -4479, -4351, -4223,
    -4095, -3967, -3839, -3711, -3583, -3455, -3327, -3199,
    -3071, -2943, -2815, -2687, -2559, -2431, -2303, -2175,
    -2047, -1919, -1791, -1663, -1535, -1407, -1279, -1151,
    -1023, -895, -767, -639, -511, -383, -255, -127,
};
static const i16 square_table[ks_1(KS_TABLE_BITS)] = {
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
};
static const i16 fake_triangle_table[ks_1(KS_TABLE_BITS)] = {
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    8191, 8191, 8191, 8191, 8191, 8191, 8191, 8191,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    16383, 16383, 16383, 16383, 16383, 16383, 16383, 16383,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    24575, 24575, 24575, 24575, 24575, 24575, 24575, 24575,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    24576, 24576, 24576, 24576, 24576, 24576, 24576, 24576,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    16384, 16384, 16384, 16384, 16384, 16384, 16384, 16384,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    8192, 8192, 8192, 8192, 8192, 8192, 8192, 8192,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -8191, -8191, -8191, -8191, -8191, -8191, -8191, -8191,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -16383, -16383, -16383, -16383, -16383, -16383, -16383, -16383,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -24575, -24575, -24575, -24575, -24575, -24575, -24575, -24575,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -32767, -32767, -32767, -32767, -32767, -32767, -32767, -32767,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -24576, -24576, -24576, -24576, -24576, -24576, -24576, -24576,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -16384, -16384, -16384, -16384, -16384, -16384, -16384, -16384,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
    -8192, -8192, -8192, -8192, -8192, -8192, -8192, -8192,
};


static const i16 noise_table[ks_1(KS_TABLE_BITS)] = {
        22293, -6921, 18552, 19557, 26976, -19820, -10798, 17578,
        -14563, 3536, -1481, 8445, -8861, 878, 29636, 27274,
        8893, 14240, -23487, 7010, -31698, -16849, -23773, 19933,
        -22499, -6491, -24261, -25636, 32696, -18463, 847, 22223,
        7381, -13366, 9014, 1591, -420, 30982, -13597, 17783,
        1752, 17688, -6538, 25658, -14200, -9668, 20166, 27460,
        -28195, 29446, 1703, -27127, -20170, 10696, 25573, -9902,
        -28561, -31454, -2771, -28632, -17151, 30842, 26358, 22997,
        -15291, 2605, -8178, 17055, 821, 10991, 2071, -30192,
        -4086, 28299, 28232, 14479, -14136, 15632, 9173, -9564,
        12311, -21890, -3925, 24907, 21573, -11118, -17761, 25779,
        -9806, 12233, 29914, 5808, 10308, 23505, -3960, 27784,
        -6655, 20627, 12072, 26932, -1147, -18623, 29506, 27532,
        -23090, 24972, 9245, -4459, 7837, -14348, 18742, -12618,
        -3471, -17949, -20477, -14664, 3698, -5472, -21651, 26659,
        -26005, -24504, -298, 17069, 31767, 28507, 12087, -7655,
        16368, -8607, -13489, -17545, 5536, -16749, -22780, 15213,
        -24544, 19232, -22012, 16060, -27882, 29497, -29324, 1413,
        -21219, -17034, 19515, 15246, 10260, 30630, 9139, 17021,
        -26640, -23926, 1324, -27640, -28185, -19355, -2528, 20949,
        4804, 16749, -29363, -22425, 32766, -19376, 25555, -24544,
        32622, -29224, 24282, -28027, -32494, 27725, 6153, -20946,
        -22076, -7097, 27067, 20950, -9234, 3439, 5205, -3107,
        12280, -26237, 2018, 16861, -12825, 32257, 5044, 24746,
        16239, 8447, -30445, 16239, 21838, 27876, 24461, 21694,
        31419, 15977, 26434, 31691, 10936, -179, -22021, 21626,
        25489, -27721, 9810, -16511, 8485, -17750, 13147, -12001,
        -11220, -17600, -27906, 8720, -18109, 9904, 700, 30897,
        -14414, 3021, 14369, -25343, -1868, 6064, 29117, -3216,
        -10724, 22785, -4291, -32555, -10161, 6453, 21838, -17439,
        11499, -1117, -1183, -12782, 13898, -20803, 7983, -30089,
        -5636, 12843, 11398, 9020, -10019, -20667, 7150, 8333,
        15120, -11247, 15756, -19515, 27584, 12107, 10035, -15907,
        2125, -27023, -15695, 24731, 12197, -26623, -25474, -9069,
        5025, 6108, 10915, -13842, 18072, -13868, -11164, -20331,
        31742, -32532, 21455, -11043, -20433, -4161, 30056, 27454,
        17358, 13046, -24828, 12175, -7612, 17974, 29034, 27280,
        23717, -19427, 19244, 3148, -13284, 26536, 26845, 24508,
        -121, 4993, -22100, -14816, 23892, -498, -2381, 22867,
        -263, -13693, -20943, 12069, 14912, -23653, 6757, -496,
        22159, 14696, -21088, -18220, -96, -24820, -23707, -9145,
        -11481, 28303, 26769, 8001, 22073, 20848, -257, -10814,
        -6925, 10408, 7135, -15799, -22856, -28012, -25699, 9647,
        -8938, -13875, -11049, -26793, -4762, 28474, 5476, -15370,
        10403, 17155, -823, -22460, 25101, 8235, 1160, -19146,
        3772, -4836, 21622, -6921, -16755, -11402, 15030, 9086,
        31773, -10600, 26053, -23849, -5846, -32412, 18564, 17981,
        -13521, -25252, 23954, 14483, -29545, -3335, 31880, 13625,
        -18946, -1710, 23931, -26612, -26242, -7674, -12991, 10296,
        20256, -24136, -29391, -29266, -2771, 18406, 12587, -3764,
        -24961, 5874, 5153, 1959, 6228, -9049, -12825, 25474,
        -1534, -21637, 7190, 1687, 7793, 6304, -17454, 21613,
        -28173, -26289, 27768, -21649, -1197, -17989, 21414, -13707,
        -9358, 24790, -10206, 20637, 10429, -30386, -15894, 18235,
        8254, 22026, -12572, -18283, -19789, 7368, -25575, 11442,
        18497, 14382, -19637, -6475, -12080, -4324, -17628, -7487,
        2152, -22627, 3630, -31811, -7850, -7722, -12752, 15558,
        -15699, 9807, 3428, 27497, 12188, 20301, 12965, -12323,
        9560, -32373, 2159, 22537, 7762, 9351, 1213, -6506,
        -9033, 14343, 19784, 11652, -22748, -30611, -28601, 12171,
        -20471, 7795, 13126, 4445, -32693, -32392, -12763, -15625,
        10181, 23432, -20894, -10396, 10966, 24838, 10046, -12239,
        25231, -20560, -22469, 226, 21557, 11511, 26486, -20242,
        -6912, 13504, 24177, 3106, 15659, 28342, -17489, 27955,
        3371, 28403, -366, 3445, 28777, 19636, 20586, 6192,
        10302, 32458, 28563, -11498, 24529, 5842, 9028, 16994,
        18049, 19326, -15545, 6840, -1929, -21825, 19364, 23925,
        24445, 10774, -5735, 7338, 6350, 9541, 2526, -23045,
        5178, -30606, 13166, 1189, 21797, 986, -25384, -667,
        678, -29588, 20600, -7558, 9021, -3137, -23331, -5696,
        -16577, -6109, -31623, 14259, 4831, 20508, 5418, -3490,
        -1483, 32450, -28918, -27900, 9224, 6375, -18178, -18363,
        8535, 27754, 15593, -2434, -4026, 22975, 29664, 29418,
        26153, 17498, -10906, 2407, -18406, -1471, 29478, -2217,
        25185, 30622, -20724, -2749, 18364, 17461, 26526, -15886,
        17144, 30375, -11019, -6397, 3983, 3568, 8006, -20248,
        -1444, -9167, 10084, 27296, -18959, 6982, 23948, -25572,
        -8286, -19725, 9602, 6074, 11570, 6313, -28909, 3989,
        4169, -16866, -31527, -10233, -32172, 27766, 6646, 17739,
        25374, 28394, -21425, -3408, -804, 19347, 9109, 30517,
        -22587, -13572, 25047, -8779, 26176, 16228, -1585, -14877,
        29270, -24750, 23964, 8073, 14330, 27821, -20704, -14267,
        -21811, -19465, 8265, -21217, -24465, -17854, 29288, -31858,
        -22227, -24903, -2500, 9734, 27211, -26157, 7485, -28143,
        -6963, -233, -4155, -13553, -16772, 27025, 4336, -20269,
        -30491, -4466, 20571, 16605, -9411, 32633, -30429, 1543,
        -19598, 10602, 13092, -11297, 25515, 9614, -10388, -29479,
        17477, 19878, 13022, 11922, 26488, -12258, 16545, -13242,
        20274, -20376, 5970, -29264, -26118, -22460, -16766, -23843,
        5840, -28962, 25528, 29195, -29095, 27866, -2028, -15926,
        5702, -21702, 5543, -1549, 20679, 27921, 1738, 5390,
        15033, -18006, -15454, 8754, 2501, -31675, 28279, -9990,
        -19285, 1482, -6488, -12637, 11789, 9511, -3713, -15136,
        13315, -10951, -18708, 16986, -15851, 12030, -31706, 22617,
        23094, 6603, -11699, 11007, 1758, 22805, -16369, -15975,
        -27967, 942, 25545, 7301, 2033, 21058, 30077, 15514,
        -10225, -9178, -29889, -31203, -32434, -835, -13573, 13648,
        20980, 485, -2131, -27638, -20251, -1071, 27745, -29923,
        -27235, -16720, 13850, 7290, -26681, 30248, 24081, -21882,
        -1576, 16860, 18186, -32309, 5151, 15496, 15972, 27692,
        -26449, 18850, 29256, -26116, -14751, -17083, 20298, -26538,
        16169, -14600, -21409, 28685, 17095, -26431, 31528, 22627,
        -10384, 12612, -2849, -4299, 10094, -11535, 6585, -24249,
        -27441, -7995, -23791, 10477, -25266, 24947, 5403, -18948,
        11031, 1892, -12297, 29046, 17576, -24766, -30259, 978,
        -6599, -18902, -3103, -22270, -12566, -4341, -32410, 9816,
        -24495, -2493, -27250, 18365, 18738, 12102, 26883, 24063,
        -28659, -29674, 1774, -21158, 28039, -25589, -7340, 6303,
        9070, 13129, 2582, -6119, 21129, 5090, 27625, -18236,
        18955, -8244, -7740, -26378, 20181, -7384, 16205, 28453,
        22889, 21722, 14052, 8860, 1057, 8169, 157, 5164,
        11261, -30835, 16773, 6534, -23657, -23333, -19929, 18179,
        22562, 15420, -20707, 10924, -12255, -25848, 25455, -26067,
        -1325, -15051, -19678, -13910, 10330, 29293, -18223, 453,
        18248, 28595, -23453, -13460, 3998, 9470, 24471, -17507,
        11402, 8477, 21793, 20511, 17910, -30902, 5924, 7705,
        17285, 17984, -14136, -27737, 24903, -21447, -21037, -9188,
        -3732, -7948, 9667, -26168, -11421, 24210, 7051, -25940,
        20039, 16365, -6633, -8729, -6930, -14929, 6530, -28295,
        26315, -4443, 24983, 11458, -2578, -1858, -13602, -18060,
        -16640, 5027, -13030, -24504, 16347, -1300, -926, -20152,
        23517, -24025, -13554, -20670, -32581, 26264, -13843, 20224,
        9862, 12289, -21271, -29835, 30127, 18025, -25364, 23675,
        -19184, 32386, 2366, 11003, -2238, 21530, 25710, 13887,
        -6208, -20086, 22149, -22628, 11379, -11543, -10013, 2130,
        -2802, 9198, 14226, -2616, 2696, -32384, -15159, -20208,
        12672, -3663, -17277, 10032, -18404, -9874, 940, -4822,
        -10254, -29459, -26585, 20273, 24838, 31891, 1393, -14136,
    };
static const u32 note_freq[128] = {
    535809, 567670, 601425, 637188, 675077, 715219, 757748, 802806,
    850544, 901120, 954703, 1011473, 1071618, 1135340, 1202850, 1274376,
    1350154, 1430438, 1515497, 1605613, 1701088, 1802240, 1909406, 2022946,
    2143236, 2270680, 2405701, 2548752, 2700308, 2860877, 3030994, 3211226,
    3402176, 3604480, 3818813, 4045892, 4286473, 4541360, 4811403, 5097504,
    5400617, 5721755, 6061988, 6422453, 6804352, 7208960, 7637627, 8091784,
    8572946, 9082720, 9622807, 10195009, 10801235, 11443510, 12123977, 12844906,
    13608704, 14417920, 15275254, 16183568, 17145893, 18165440, 19245614, 20390018,
    21602471, 22887021, 24247954, 25689812, 27217408, 28835840, 30550508, 32367136,
    34291786, 36330881, 38491228, 40780036, 43204943, 45774042, 48495908, 51379625,
    54434817, 57671680, 61101016, 64734272, 68583572, 72661763, 76982456, 81560072,
    86409886, 91548085, 96991817, 102759251, 108869634, 115343360, 122202033, 129468544,
    137167144, 145323527, 153964913, 163120144, 172819772, 183096171, 193983635, 205518503,
    217739269, 230686720, 244404066, 258937088, 274334288, 290647054, 307929827, 326240288,
    345639545, 366192342, 387967271, 411037006, 435478538, 461373440, 488808132, 517874176,
    548668577, 581294108, 615859655, 652480576, 691279090, 732384684, 775934543, 822074012,
};
static const i32 ratescale[128] = {
    3461439, 3263485, 3076641, 2900284, 2733826, 2576709, 2428412, 2288437,
    2156319, 2031616, 1913911, 1802814, 1697951, 1598974, 1505552, 1417374,
    1334145, 1255586, 1181438, 1111450, 1045391, 983040, 924187, 868639,
    816207, 766719, 720008, 675919, 634304, 595025, 557951, 522957,
    489927, 458752, 429325, 401551, 375335, 350591, 327236, 305191,
    284384, 264744, 246207, 228710, 212195, 196608, 181894, 168007,
    154899, 142527, 130850, 119827, 109424, 99604, 90335, 81587,
    73329, 65536, 58179, 51235, 44681, 38495, 32657, 27145,
    21944, 17034, 12399, 8025, 3896, 0, -3679, -7151,
    -10428, -13521, -16440, -19196, -21796, -24251, -26569, -28756,
    -30820, -32768, -34608, -36344, -37982, -39529, -40988, -42366,
    -43666, -44894, -46053, -47146, -48178, -49152, -50072, -50940,
    -51759, -52533, -53262, -53951, -54601, -55215, -55795, -56341,
    -56857, -57344, -57804, -58238, -58648, -59035, -59399, -59744,
    -60069, -60376, -60666, -60939, -61197, -61440, -61670, -61887,
    -62092, -62286, -62468, -62640, -62803, -62956, -63101, -63238,
};


KS_INLINE const i16* ks_get_wave_table(u8 index){
    switch (index) {
    case KS_WAVE_SIN:
        return sin_table;
    case KS_WAVE_SAW_UP:
        return saw_table;
    case KS_WAVE_SAW_DOWN:
        return saw_minus_table;
    case KS_WAVE_SQUARE:
        return square_table;
    case KS_WAVE_TRIANGLE:
        return triangle_table;
    case KS_WAVE_FAKE_TRIANGLE:
        return fake_triangle_table;
    case KS_WAVE_NOISE:
        return 0;
    }
    return NULL;
}

KS_FORCEINLINE const i16* ks_get_noise_table(){
    return noise_table;
}

// sin table value
KS_INLINE i16 ks_sin(u32 phase)
{
    return sin_table[ks_mask(phase >> KS_PHASE_BITS, KS_TABLE_BITS)];
}

KS_INLINE i16 ks_noise(u32 phase){
    return noise_table[ks_mask((((phase >> KS_NOISE_PHASE_BITS))), KS_TABLE_BITS)];
}

KS_INLINE u32 ks_notefreq(u8 notenumber){
    return note_freq[notenumber];
}

KS_INLINE i32 ks_ratescale(u8 notenumber){
    return ratescale[notenumber];
}

